/* ===== Nền tổng thể giống Tailwind gradient ===== */
:root{
    --text:#1f2937; --muted:#6b7280;
    --card:#fff; --radius-xl:20px; --radius-2xl:28px;
    --shadow:0 12px 30px rgba(0,0,0,.08);
    --purple:#7c3aed; --purple-weak:#ede9fe; --purple-border:#c4b5fd;
    --blue:#1d4ed8; --blue-weak:#dbeafe; --blue-border:#93c5fd;
    --red:#dc2626; --red-weak:#fee2e2; --red-border:#fecaca;
    --amber:#b45309; --amber-weak:#fef3c7; --amber-border:#fcd34d;
    --green:#16a34a; --green-weak:#dcfce7; --green-border:#86efac;
    --orange:#b45309; --orange-weak:#ffedd5; --orange-border:#fdba74;
    --dur: 12s;              /* Fallback cho animation duration */
    --delay: 0s;             /* Fallback cho delay */
    --x: 0;                  /* Fallback cho translate x */
}

*{box-sizing:border-box} html,body{height:100%}
body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:var(--text)}

.app-bg{
    background: radial-gradient(1200px 600px at 20% -10%,#eef2ff,transparent),
    radial-gradient(1000px 500px at 100% 20%,#fde7f3,transparent),
    linear-gradient(135deg,#eef2ff 0%, #faf5ff 45%, #fff1f2 100%);
    min-height:100%;
}

.container{max-width:1100px;margin:0 auto;padding:24px}

.header{display:flex; align-items:center; justify-content: space-between; gap: 12px; margin-bottom: 16px; }
.title{
    text-align:center;margin:0 0 36px;font-weight:900;
    font-size:clamp(24px,4vw,40px);
    background:linear-gradient(90deg,#7c3aed,#db2777,#f97316);
    -webkit-background-clip:text;background-clip:text;color:transparent;
}

.toggle{ display:flex; align-items:center; gap:10px; background:#f0f3f9; padding:10px 12px; border-radius: 12px; width: fit-content; }

/* ===== Lưới 2 cột ===== */
.grid{display:grid;gap:24px}
@media(min-width:900px){.grid{grid-template-columns:1fr 1fr}}

.face-card{
    position:relative; background:linear-gradient(135deg,#fffbeb,#fef3c7);
    border:4px solid #fcd34d; border-radius:24px; padding:28px; box-shadow:var(--shadow);
}
.glow{position:absolute; inset:24px; border-radius:999px; background:#fde68a; filter:blur(40px); opacity:.35; pointer-events:none}
.face{
    position:relative; margin:0 auto; width:min(20rem,70vw); height:min(20rem,70vw);
    background:linear-gradient(135deg,#fde68a,#facc15);
    border:8px solid #f59e0b; border-radius:999px; box-shadow:0 20px 50px rgba(245,158,11,.35);
}
.eye{position:absolute; top:22%; width:1.2rem; height:1.2rem; background:#111827; border-radius:999px}
.eye-left{left:22%} .eye-right{right:22%}
.smile{position:absolute; bottom:18%; left:50%; transform:translateX(-50%); width:120px; height:60px}
.smile path{stroke:#1f2937; stroke-width:8; fill:none; stroke-linecap:round}
.caption{text-align:center;color:var(--muted); margin:14px 0 0}

/* ===== Options ===== */
.options{display:flex; flex-direction:column; gap:16px}
.option{
    display:flex; align-items:center; gap:12px; justify-content:center;
    width:100%; padding:22px; border-radius:18px; border:2px solid #e5e7eb;
    background:#fff; box-shadow:0 6px 18px rgba(0,0,0,.04);
    font-weight:800; font-size:18px; cursor:pointer; transition:.22s transform,.22s box-shadow,.22s border-color;
}
.option:hover{transform:scale(1.02); box-shadow:0 12px 28px rgba(0,0,0,.08); border-color:#d1d5db}
.option:focus-visible{outline:none; box-shadow:0 0 0 6px #e0e7ff}

.option .emoji{font-size:28px}
.check{margin-left:auto; opacity:0; transition:.2s opacity}

/* Trạng thái chọn + phối màu */
.option.selected{border-width:4px; transform:scale(1.02)}
.option.selected .check{opacity:1}

.color-purple{background:linear-gradient(90deg,#f3e8ff,#ffe4e6); border-color:var(--purple-border)}
.color-purple .label{color:var(--purple)}

.color-blue{background:linear-gradient(90deg,#dbeafe,#cffafe); border-color:var(--blue-border)}
.color-blue .label{color:var(--blue)}

.color-red{background:linear-gradient(90deg,#fee2e2,#ffedd5); border-color:var(--red-border)}
.color-red .label{color:var(--red)}

.color-amber{background:linear-gradient(90deg,#fef3c7,#fef9c3); border-color:var(--amber-border)}
.color-amber .label{color:var(--amber)}

/* ===== Feedback ===== */
.feedback{
    margin:24px 0; padding:18px; border-radius:18px; border:3px solid transparent;
    font-weight:700; text-align:center; box-shadow:0 8px 22px rgba(0,0,0,.06);
}
.feedback-neutral{color:var(--muted); background:#f8fafc; border-color:#e5e7eb}
.feedback-correct{color:var(--green); background:linear-gradient(90deg,var(--green-weak),#e9fce6); border-color:var(--green-border)}
.feedback-incorrect{color:var(--orange); background:linear-gradient(90deg,var(--orange-weak),#ffe8d6); border-color:var(--orange-border)}

/* ===== Buttons ===== */
.actions{display:flex; gap:12px; justify-content:center}
.btn{padding:14px 22px; border-radius:14px; font-weight:800; border:2px solid transparent; cursor:pointer; transition:.2s transform,.2s box-shadow,.2s background}
.btn:active{transform:translateY(1px)}
.btn-outline{background:#eef2ff; border-color:#c7d2fe}
.btn-outline:hover{background:#e0e7ff}
.btn-primary{color:#fff; background:linear-gradient(90deg,#7c3aed,#db2777)}
.btn-primary:hover{filter:brightness(.95)}

/* Chế độ ít kích thích: nền phẳng, bỏ bóng/gradient mạnh */
.low-stimulus body, body.low-stimulus{ background: #f6f7f9; }
.low-stimulus .btn, body.low-stimulus .btn{ box-shadow: none; }
.low-stimulus .hero, body.low-stimulus .hero{ background: none; background-color: #f2f6fa; }

/* --- Tuyết rơi nhẹ --- */
.snow {
    position: fixed;
    inset: 0;
    pointer-events: none;
    overflow: hidden;
    z-index: 1;
}

.snowflake{
    position: absolute;
    top: -2rem;
    width: 120px; height: 80px; /* Fallback kích thước lớn nếu JS chưa load */
    border-radius: 50%; /* Hình tròn, có thể thay bằng 0 để vuông */
    background: rgba(255,255,255,0.95); /* Nền trắng trong suốt nhẹ */
    filter: drop-shadow(0 4px 6px rgba(0,0,0,0.1)); /* Shadow để nổi bật */
    opacity: 1; /* Max opacity */
    animation: fall linear var(--dur,12s) var(--delay,0s) infinite;
}

@keyframes fall{
    0%   { transform: translate3d(var(--x,0), -2rem, 0) rotate(0deg); opacity: 0; }
    5%   { opacity: 0.95; }
    100% { transform: translate3d(var(--x,0), 110vh, 0) rotate(360deg); opacity: 1; }
}

@media (prefers-reduced-motion: reduce){
    .snowflake{ animation-duration: calc(var(--dur,12s) * 2); opacity: 0.7; }
}

.low-stimulus .snowflake, body.low-stimulus .snowflake{
    animation: none !important;
    display: none !important;
}